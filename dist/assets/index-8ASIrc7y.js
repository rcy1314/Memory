var p=(S,w,m)=>new Promise((n,r)=>{var b=u=>{try{d(m.next(u))}catch(f){r(f)}},e=u=>{try{d(m.throw(u))}catch(f){r(f)}},d=u=>u.done?n(u.value):Promise.resolve(u.value).then(b,e);d((m=m.apply(S,w)).next())});import{a1 as y,d8 as N,a5 as x,r as c,o as z,ac as $,P as U,R as s,Q as F,_ as V,a0 as i,W as o,aH as k,X as C,Z as B,az as I}from"./index-ON-SflwH.js";import{_ as R}from"./CommonPage-Dj5qqsUj.js";import{N as D,a as _}from"./FormItem-CFjxQbHB.js";import{N as M}from"./InputNumber-BfqzlnEt.js";import{N as v}from"./Input-Ck59uIzx.js";import{N as g}from"./Switch-D3pB72jH.js";import"./AppPage-wwO3nDER.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./format-length-B-p6aW7q.js";import"./use-locale-gdUNdwpT.js";import"./Add-CAjrcp6O.js";const T={class:"m-30 flex items-center"},J={__name:"index",setup(S){const{t:w}=y(),m=N(),n=x(),r=c(!1),b=c(null),e=c({page_size:"",thumbnail_suffix:"",detail_suffix:"",thumbnail_show_location:!1,detail_show_location:!1,thumbnail_show_time:!1,thumbnail_time_format:"",detail_show_time:!1,detail_time_format:""});function d(){console.log("初始化表单数据，contentSetting:",n.contentSetting),e.value={page_size:n.contentSetting.page_size||"",thumbnail_suffix:n.contentSetting.thumbnail_suffix||"",detail_suffix:n.contentSetting.detail_suffix||"",thumbnail_show_location:n.contentSetting.thumbnail_show_location||!1,detail_show_location:n.contentSetting.detail_show_location||!1,thumbnail_show_time:n.contentSetting.thumbnail_show_time||!1,thumbnail_time_format:n.contentSetting.thumbnail_time_format||"",detail_show_time:n.contentSetting.detail_show_time||!1,detail_time_format:n.contentSetting.detail_time_format||""},console.log("初始化后的表单数据:",e.value)}z(()=>p(this,null,function*(){console.log("页面挂载，开始获取内容设置数据");const t=yield n.getContentSetting();console.log("获取内容设置结果:",t),console.log("store中的contentSetting:",n.contentSetting),yield $(),d()}));function u(){return p(this,null,function*(){var t;r.value=!0,(t=b.value)==null||t.validate(l=>p(this,null,function*(){if(l){r.value=!1;return}const a={content:e.value};console.log("准备发送的内容设置数据:",a),console.log("表单数据:",e.value);try{const h=yield I.updateContentSetting(a);console.log("保存成功响应:",h),yield n.getContentSetting(),yield $(),d(),m.success(w("common.text.save_success"))}catch(h){console.error("保存失败:",h),m.error("保存失败: "+(h.message||"未知错误"))}finally{r.value=!1}}))})}const f={};return(t,l)=>(F(),U(R,{title:t.$t("views.setting.label_content_setting")},{default:s(()=>[V("div",T,[i(o(D),{ref_key:"infoFormRef",ref:b,"label-placement":"top","label-align":"left","label-width":"100",model:e.value,rules:f,class:"w-500"},{default:s(()=>[i(o(_),{label:t.$t("views.setting.label_page_size"),path:"page_size"},{default:s(()=>[i(o(M),{modelValue:e.value.page_size,"onUpdate:modelValue":l[0]||(l[0]=a=>e.value.page_size=a),clearable:"",precision:0,placeholder:t.$t("views.setting.placeholder_page_size")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),i(o(_),{label:t.$t("views.setting.label_thumbnail_suffix"),path:"thumbnail_suffix"},{default:s(()=>[i(o(v),{value:e.value.thumbnail_suffix,"onUpdate:value":l[1]||(l[1]=a=>e.value.thumbnail_suffix=a),type:"text",placeholder:t.$t("views.setting.placeholder_thumbnail_suffix"),clearable:""},null,8,["value","placeholder"])]),_:1},8,["label"]),i(o(_),{label:t.$t("views.setting.label_detail_suffix"),path:"detail_suffix"},{default:s(()=>[i(o(v),{value:e.value.detail_suffix,"onUpdate:value":l[2]||(l[2]=a=>e.value.detail_suffix=a),type:"text",placeholder:t.$t("views.setting.placeholder_detail_suffix"),clearable:""},null,8,["value","placeholder"])]),_:1},8,["label"]),i(o(_),{label:t.$t("views.setting.label_thumbnail_show_location"),path:"thumbnail_show_location"},{default:s(()=>[i(o(g),{value:e.value.thumbnail_show_location,"onUpdate:value":l[3]||(l[3]=a=>e.value.thumbnail_show_location=a)},null,8,["value"])]),_:1},8,["label"]),i(o(_),{label:t.$t("views.setting.label_detail_show_location"),path:"detail_show_location"},{default:s(()=>[i(o(g),{value:e.value.detail_show_location,"onUpdate:value":l[4]||(l[4]=a=>e.value.detail_show_location=a)},null,8,["value"])]),_:1},8,["label"]),i(o(_),{label:t.$t("views.setting.label_thumbnail_show_time"),path:"thumbnail_show_time"},{default:s(()=>[i(o(g),{value:e.value.thumbnail_show_time,"onUpdate:value":l[5]||(l[5]=a=>e.value.thumbnail_show_time=a)},null,8,["value"])]),_:1},8,["label"]),i(o(_),{label:t.$t("views.setting.label_thumbnail_time_format"),path:"thumbnail_time_format"},{default:s(()=>[i(o(v),{value:e.value.thumbnail_time_format,"onUpdate:value":l[6]||(l[6]=a=>e.value.thumbnail_time_format=a),type:"text",disabled:!e.value.thumbnail_show_time,placeholder:t.$t("views.setting.placeholder_thumbnail_time_format"),clearable:""},null,8,["value","disabled","placeholder"])]),_:1},8,["label"]),i(o(_),{label:t.$t("views.setting.label_detail_show_time"),path:"detail_show_time"},{default:s(()=>[i(o(g),{value:e.value.detail_show_time,"onUpdate:value":l[7]||(l[7]=a=>e.value.detail_show_time=a)},null,8,["value"])]),_:1},8,["label"]),i(o(_),{label:t.$t("views.setting.label_detail_time_format"),path:"detail_time_format"},{default:s(()=>[i(o(v),{value:e.value.detail_time_format,"onUpdate:value":l[8]||(l[8]=a=>e.value.detail_time_format=a),type:"text",disabled:!e.value.detail_show_time,placeholder:t.$t("views.setting.placeholder_detail_time_format"),clearable:""},null,8,["value","disabled","placeholder"])]),_:1},8,["label"]),i(o(k),{type:"primary",loading:r.value,onClick:u},{default:s(()=>[C(B(t.$t("common.buttons.save")),1)]),_:1},8,["loading"])]),_:1},8,["model"])])]),_:1},8,["title"]))}};export{J as default};
